<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${category != null ? category.ten : 'Danh Mục'} + ' - NiceSport'">Danh Mục - NiceSport</title>

    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Custom CSS -->
    <link rel="stylesheet" th:href="@{/css/index.css}">
    <link rel="stylesheet" th:href="@{/css/category.css}">
</head>
<body>

<!-- ========== NAVBAR (Include từ index.html) ========== -->
<nav class="navbar navbar-light bg-white shadow-sm sticky-top">
    <!-- Top Bar -->
    <div class="navbar-top">
        <div class="section-wrapper">
            <div class="d-flex justify-content-between align-items-center">
                <div class="top-links">
                    <a href="/" class="top-link">Danh mục</a>
                    <span class="divider">|</span>
                    <a href="/download" class="top-link">Tải ứng dụng</a>
                    <span class="divider">|</span>
                    <span class="top-link">Kết nối</span>
                    <a href="#" class="social-icon"><i class="fab fa-facebook-f"></i></a>
                    <a href="#" class="social-icon"><i class="fab fa-instagram"></i></a>
                </div>
                <div class="top-links">
                    <a href="#" class="top-link">
                        <i class="far fa-bell me-1"></i>Thông Báo
                    </a>
                    <a href="#" class="top-link">
                        <i class="far fa-question-circle me-1"></i>Hỗ Trợ
                    </a>
                    <a href="#" class="top-link">
                        <i class="fas fa-globe me-1"></i>Tiếng Việt
                        <i class="fas fa-chevron-down ms-1 small"></i>
                    </a>
                    <a th:href="@{/login}" class="top-link">
                        <i class="far fa-user-circle me-1"></i>Đăng nhập
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Main Navbar -->
    <div class="navbar-main">
        <div class="section-wrapper">
            <div class="row align-items-center w-100 g-3">
                <!-- Logo -->
                <div class="col-auto">
                    <a class="navbar-brand d-flex align-items-center" th:href="@{/Index}">
                        <div class="logo-icon">
                            <i class="fas fa-running"></i>
                        </div>
                        <span class="logo-text ms-2">NiceSport</span>
                    </a>
                </div>

                <!-- Search Box -->
                <div class="col">
                    <form action="/search" method="get" class="search-form">
                        <div class="search-box-main">
                            <input type="text" name="search" class="search-input-main"
                                   placeholder="Tìm giày thể thao, sneaker, sandals...">
                            <button type="submit" class="btn-search-main">
                                <i class="fas fa-search"></i>
                            </button>
                        </div>
                    </form>
                </div>

                <!-- Cart -->
                <div class="col-auto">
                    <a th:href="@{/cart}" class="cart-icon-main position-relative">
                        <i class="fas fa-shopping-cart"></i>
                        <span class="cart-badge-main">0</span>
                    </a>
                </div>
            </div>
        </div>
    </div>
</nav>

<!-- ========== BREADCRUMB ========== -->
<section class="breadcrumb-section">
    <div class="section-wrapper">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb-shopee">
                <li class="breadcrumb-item"><a href="/">NiceSport</a></li>
                <li class="breadcrumb-item active" th:text="${category != null ? category.ten : 'Danh Mục'}">Giày Thể Thao</li>
            </ol>
        </nav>
    </div>
</section>

<!-- ========== FILTER & PRODUCTS ========== -->
<section class="category-content-section">
    <div class="section-wrapper">
        <div class="row g-3">
            <!-- ========== SIDEBAR FILTERS ========== -->
            <div class="col-lg-2 d-none d-lg-block">
                <div class="filter-sidebar">
                    <!-- Category Filter -->
                    <div class="filter-group">
                        <h6 class="filter-title">
                            <i class="fas fa-th-large me-2"></i>Danh Mục
                        </h6>
                        <ul class="filter-list">
                            <li th:each="cat : ${allCategories}">
                                <a th:href="@{/category/{id}(id=${cat.danhMucId})}"
                                   th:class="${category != null && cat.danhMucId == category.danhMucId ? 'filter-item active' : 'filter-item'}">
                                    <span th:text="${cat.ten}">Giày Thể Thao</span>
                                    <span class="product-count" th:if="${cat.productCount != null}"
                                          th:text="'(' + ${cat.productCount} + ')'"></span>
                                </a>
                            </li>
                        </ul>
                    </div>

                    <!-- Brand Filter -->
                    <div class="filter-group">
                        <h6 class="filter-title">
                            <i class="fas fa-tags me-2"></i>Thương Hiệu
                        </h6>
                        <div class="filter-search-box">
                            <input type="text" id="brandSearch" class="filter-search-input" placeholder="Tìm thương hiệu...">
                            <i class="fas fa-search"></i>
                        </div>
                        <ul class="filter-list filter-list-scrollable" id="brandList">
                            <li th:each="brand : ${brands}">
                                <label class="filter-checkbox-item">
                                    <input type="checkbox" name="brand" th:value="${brand.thuongHieuId}">
                                    <span th:text="${brand.ten}">Nike</span>
                                    <span class="product-count" th:if="${brand.productCount != null}"
                                          th:text="'(' + ${brand.productCount} + ')'"></span>
                                </label>
                            </li>
                        </ul>
                    </div>

                    <!-- Price Filter -->
                    <div class="filter-group">
                        <h6 class="filter-title">
                            <i class="fas fa-dollar-sign me-2"></i>Khoảng Giá
                        </h6>
                        <ul class="filter-list">
                            <li>
                                <label class="filter-checkbox-item">
                                    <input type="radio" name="priceRange" value="0-500000">
                                    <span>Dưới 500.000₫</span>
                                </label>
                            </li>
                            <li>
                                <label class="filter-checkbox-item">
                                    <input type="radio" name="priceRange" value="500000-1000000">
                                    <span>500.000₫ - 1.000.000₫</span>
                                </label>
                            </li>
                            <li>
                                <label class="filter-checkbox-item">
                                    <input type="radio" name="priceRange" value="1000000-2000000">
                                    <span>1.000.000₫ - 2.000.000₫</span>
                                </label>
                            </li>
                            <li>
                                <label class="filter-checkbox-item">
                                    <input type="radio" name="priceRange" value="2000000-5000000">
                                    <span>2.000.000₫ - 5.000.000₫</span>
                                </label>
                            </li>
                            <li>
                                <label class="filter-checkbox-item">
                                    <input type="radio" name="priceRange" value="5000000-999999999">
                                    <span>Trên 5.000.000₫</span>
                                </label>
                            </li>
                        </ul>
                        <div class="price-range-custom">
                            <input type="number" class="price-input" placeholder="₫ TỪ" id="priceMin">
                            <span class="price-separator">-</span>
                            <input type="number" class="price-input" placeholder="₫ ĐẾN" id="priceMax">
                        </div>
                        <button class="btn-apply-price">Áp dụng</button>
                    </div>

                    <!-- Size Filter -->
                    <div class="filter-group">
                        <h6 class="filter-title">
                            <i class="fas fa-ruler me-2"></i>Kích Thước
                        </h6>
                        <div class="size-filter-grid">
                            <label class="size-item" th:each="size : ${sizes}">
                                <input type="checkbox" name="size" th:value="${size.kichThuocId}">
                                <span th:text="${size.ten}">39</span>
                            </label>
                        </div>
                    </div>

                    <!-- Color Filter -->
                    <div class="filter-group">
                        <h6 class="filter-title">
                            <i class="fas fa-palette me-2"></i>Màu Sắc
                        </h6>
                        <div class="color-filter-grid">
                            <label class="color-item" th:each="color : ${colors}">
                                <input type="checkbox" name="color" th:value="${color.mauSacId}">
                                <span class="color-swatch"
                                      th:style="'background-color: ' + ${color.maHex}"
                                      th:title="${color.ten}"></span>
                                <span class="color-name" th:text="${color.ten}">Đen</span>
                            </label>
                        </div>
                    </div>

                    <!-- Material Filter -->
                    <div class="filter-group">
                        <h6 class="filter-title">
                            <i class="fas fa-tshirt me-2"></i>Chất Liệu
                        </h6>
                        <ul class="filter-list">
                            <li th:each="material : ${materials}">
                                <label class="filter-checkbox-item">
                                    <input type="checkbox" name="material" th:value="${material.chatLieuId}">
                                    <span th:text="${material.ten}">Da thật</span>
                                </label>
                            </li>
                        </ul>
                    </div>

                    <!-- Rating Filter -->
                    <div class="filter-group">
                        <h6 class="filter-title">
                            <i class="fas fa-star me-2"></i>Đánh Giá
                        </h6>
                        <ul class="filter-list">
                            <li>
                                <label class="filter-checkbox-item">
                                    <input type="radio" name="rating" value="5">
                                    <div class="rating-stars">
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                    </div>
                                </label>
                            </li>
                            <li>
                                <label class="filter-checkbox-item">
                                    <input type="radio" name="rating" value="4">
                                    <div class="rating-stars">
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="far fa-star"></i>
                                        <span class="ms-2">trở lên</span>
                                    </div>
                                </label>
                            </li>
                            <li>
                                <label class="filter-checkbox-item">
                                    <input type="radio" name="rating" value="3">
                                    <div class="rating-stars">
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="far fa-star"></i>
                                        <i class="far fa-star"></i>
                                        <span class="ms-2">trở lên</span>
                                    </div>
                                </label>
                            </li>
                        </ul>
                    </div>

                    <!-- Reset Button -->
                    <button class="btn-reset-filters">
                        <i class="fas fa-redo me-2"></i>Xóa tất cả
                    </button>
                </div>
            </div>

            <!-- ========== PRODUCTS AREA ========== -->
            <div class="col-lg-10">
                <!-- Sort Bar -->
                <div class="sort-bar">
                    <div class="sort-label">Sắp xếp theo</div>
                    <div class="sort-options">
                        <button class="sort-btn active" data-sort="popular">Phổ Biến</button>
                        <button class="sort-btn" data-sort="newest">Mới Nhất</button>
                        <button class="sort-btn" data-sort="bestseller">Bán Chạy</button>
                        <div class="sort-dropdown">
                            <button class="sort-btn dropdown-toggle" data-bs-toggle="dropdown">
                                Giá
                                <i class="fas fa-chevron-down ms-1"></i>
                            </button>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item" href="#" data-sort="price-asc">Giá: Thấp đến Cao</a></li>
                                <li><a class="dropdown-item" href="#" data-sort="price-desc">Giá: Cao đến Thấp</a></li>
                            </ul>
                        </div>
                    </div>
                    <div class="sort-page-info">
                        <span class="current-page-info">
                            <span th:text="${currentPage + 1}">1</span>/<span th:text="${totalPages}">10</span>
                        </span>
                        <div class="page-nav-buttons">
                            <button class="page-nav-btn" th:disabled="${currentPage == 0}">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <button class="page-nav-btn" th:disabled="${currentPage >= totalPages - 1}">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Products Grid -->
                <div class="products-grid-shopee">
                    <div class="row g-2">
                        <div class="col-lg-2-4 col-md-3 col-sm-4 col-6"
                             th:each="product : ${products}">
                            <a th:href="@{/product/{id}(id=${product.sanPhamId})}" class="product-card-shopee">
                                <div class="product-image-shopee">
                                    <img th:if="${product.hinhAnhChinh != null}"
                                         th:src="${product.hinhAnhChinh}"
                                         th:alt="${product.ten}"
                                         class="img-fluid">
                                    <img th:if="${product.hinhAnhChinh == null}"
                                         src="https://images.unsplash.com/photo-1542291026-7eec264c27ff?w=400"
                                         th:alt="${product.ten}"
                                         class="img-fluid">
                                    <div class="product-badges-shopee">
                                        <span class="badge-discount" th:if="${product.tyLeGiamGia != null && product.tyLeGiamGia > 0}">
                                            <span th:text="${product.tyLeGiamGia}">15</span>% GIẢM
                                        </span>
                                        <span class="badge-brand" th:if="${product.thuongHieuTen != null}"
                                              th:text="${product.thuongHieuTen}">Nike</span>
                                    </div>
                                </div>
                                <div class="product-info-shopee">
                                    <h6 class="product-name-shopee" th:text="${product.ten}">Nike Air Max 2024</h6>
                                    <div class="product-price-shopee">
                                        <span class="price-current" th:text="${product.giaMinFormatted} + '₫'">1.500.000₫</span>
                                        <span class="price-old" th:if="${product.giaGocMin != null && product.giaGocMin > product.giaMin}"
                                              th:text="${product.giaGocMinFormatted} + '₫'">2.000.000₫</span>
                                    </div>
                                    <div class="product-stats-shopee">
                                        <div class="product-rating">
                                            <i class="fas fa-star"></i>
                                            <span>4.8</span>
                                        </div>
                                        <span class="product-sold">Đã bán 2.5k</span>
                                    </div>
                                </div>
                                <div class="product-location-shopee">
                                    <i class="fas fa-map-marker-alt me-1"></i>TP. Hồ Chí Minh
                                </div>
                            </a>
                        </div>
                    </div>
                </div>

                <!-- No Results -->
                <div class="no-results" th:if="${products == null || products.empty}">
                    <i class="fas fa-search"></i>
                    <h5>Không tìm thấy kết quả nào</h5>
                    <p>Hãy thử sử dụng các từ khóa chung chung hơn</p>
                    <a href="/" class="btn btn-primary">Về Trang Chủ</a>
                </div>

                <!-- Pagination -->
                <nav th:if="${totalPages > 1}" class="mt-4">
                    <ul class="pagination-shopee">
                        <li class="page-item-shopee" th:classappend="${currentPage == 0 ? 'disabled' : ''}">
                            <a class="page-link-shopee"
                               th:href="@{/category/{id}(id=${category.danhMucId}, page=${currentPage - 1})}">
                                <i class="fas fa-chevron-left"></i>
                            </a>
                        </li>

                        <!-- First page -->
                        <li class="page-item-shopee" th:if="${currentPage > 2}">
                            <a class="page-link-shopee"
                               th:href="@{/category/{id}(id=${category.danhMucId}, page=0)}">1</a>
                        </li>
                        <li class="page-item-shopee disabled" th:if="${currentPage > 3}">
                            <span class="page-link-shopee">...</span>
                        </li>

                        <!-- Pages around current -->
                        <li class="page-item-shopee"
                            th:each="i : ${#numbers.sequence(currentPage - 2 < 0 ? 0 : currentPage - 2,
                                                            currentPage + 2 >= totalPages ? totalPages - 1 : currentPage + 2)}"
                            th:classappend="${i == currentPage ? 'active' : ''}">
                            <a class="page-link-shopee"
                               th:href="@{/category/{id}(id=${category.danhMucId}, page=${i})}"
                               th:text="${i + 1}">1</a>
                        </li>

                        <!-- Last page -->
                        <li class="page-item-shopee disabled" th:if="${currentPage < totalPages - 4}">
                            <span class="page-link-shopee">...</span>
                        </li>
                        <li class="page-item-shopee" th:if="${currentPage < totalPages - 3}">
                            <a class="page-link-shopee"
                               th:href="@{/category/{id}(id=${category.danhMucId}, page=${totalPages - 1})}"
                               th:text="${totalPages}">10</a>
                        </li>

                        <li class="page-item-shopee"
                            th:classappend="${currentPage >= totalPages - 1 ? 'disabled' : ''}">
                            <a class="page-link-shopee"
                               th:href="@{/category/{id}(id=${category.danhMucId}, page=${currentPage + 1})}">
                                <i class="fas fa-chevron-right"></i>
                            </a>
                        </li>
                    </ul>
                </nav>
            </div>
        </div>
    </div>
</section>

<!-- ========== FOOTER ========== -->
<footer class="footer-shopee">
    <div class="footer-top">
        <div class="section-wrapper">
            <div class="row g-4">
                <div class="col-lg-3 col-md-6">
                    <h6 class="footer-heading">CHĂM SÓC KHÁCH HÀNG</h6>
                    <ul class="footer-links">
                        <li><a href="#">Trung Tâm Trợ Giúp</a></li>
                        <li><a href="#">Hướng Dẫn Mua Hàng</a></li>
                        <li><a href="#">Chính Sách Đổi Trả</a></li>
                        <li><a href="#">Liên Hệ</a></li>
                    </ul>
                </div>
                <div class="col-lg-3 col-md-6">
                    <h6 class="footer-heading">VỀ NICESPORT</h6>
                    <ul class="footer-links">
                        <li><a href="#">Giới Thiệu</a></li>
                        <li><a href="#">Tuyển Dụng</a></li>
                        <li><a href="#">Điều Khoản</a></li>
                        <li><a href="#">Chính Sách Bảo Mật</a></li>
                    </ul>
                </div>
                <div class="col-lg-3 col-md-6">
                    <h6 class="footer-heading">THANH TOÁN</h6>
                    <div class="payment-methods">
                        <img src="https://down-vn.img.susercontent.com/file/d4bbea4570b93bfd5fc652ca82a262a8" alt="COD">
                        <img src="https://down-vn.img.susercontent.com/file/a0a9062ebe19b45c1ae0506f16af5c16" alt="Card">
                    </div>
                </div>
                <div class="col-lg-3 col-md-6">
                    <h6 class="footer-heading">THEO DÕI CHÚNG TÔI</h6>
                    <ul class="footer-links">
                        <li><a href="#"><i class="fab fa-facebook me-2"></i>Facebook</a></li>
                        <li><a href="#"><i class="fab fa-instagram me-2"></i>Instagram</a></li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <div class="footer-bottom">
        <div class="section-wrapper">
            <div class="text-center">
                <p class="mb-0">© 2025 NiceSport. Tất cả các quyền được bảo lưu.</p>
            </div>
        </div>
    </div>
</footer>

<!-- Scroll to Top -->
<button class="scroll-to-top" id="scrollToTop">
    <i class="fas fa-chevron-up"></i>
</button>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<!-- Custom JS -->
<script>
    // Scroll to top
    const scrollBtn = document.getElementById('scrollToTop');
    window.addEventListener('scroll', () => {
        scrollBtn.classList.toggle('show', window.pageYOffset > 300);
    });
    scrollBtn.addEventListener('click', () => {
        window.scrollTo({ top: 0, behavior: 'smooth' });
    });

    // Brand search filter
    const brandSearch = document.getElementById('brandSearch');
    if (brandSearch) {
        brandSearch.addEventListener('input', function() {
            const searchTerm = this.value.toLowerCase();
            const brandItems = document.querySelectorAll('#brandList li');
            brandItems.forEach(item => {
                const text = item.textContent.toLowerCase();
                item.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        });
    }

    // Sort buttons
    document.querySelectorAll('.sort-btn, .dropdown-item').forEach(btn => {
        btn.addEventListener('click', function(e) {
            if (!this.classList.contains('dropdown-toggle')) {
                document.querySelectorAll('.sort-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
            }
        });
    });

    // Sticky navbar
    let lastScrollTop = 0;
    const navbar = document.querySelector('.navbar');
    window.addEventListener('scroll', function() {
        const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
        if (scrollTop > lastScrollTop && scrollTop > 80) {
            navbar.classList.add('hide');
        } else if (scrollTop < lastScrollTop - 5) {
            navbar.classList.remove('hide');
        }
        lastScrollTop = scrollTop <= 0 ? 0 : scrollTop;
    });
</script>
</body>
</html>
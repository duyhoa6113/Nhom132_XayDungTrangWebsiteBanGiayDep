<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quên mật khẩu - NiceSport</title>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

    <!-- Custom CSS -->
    <link rel="stylesheet" th:href="@{/css/forgot-password.css}">
</head>
<body>
<div class="auth-wrapper">
    <!-- Header -->
    <header class="auth-navbar">
        <div class="container-fluid px-4">
            <div class="d-flex justify-content-between align-items-center">
                <a th:href="@{/Index}" class="auth-logo">
                    <i class="fas fa-running me-2"></i>
                    NiceSport
                </a>
                <div class="auth-breadcrumb">
                    <a th:href="@{/auth/login}">Đăng nhập</a>
                    <span class="mx-2">></span>
                    <span>Quên mật khẩu</span>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <div class="auth-container">
        <div class="row g-0">
            <!-- Left Side - Information -->
            <div class="col-lg-5">
                <div class="auth-left-panel">
                    <h1 class="auth-title">Quên mật khẩu</h1>
                    <p class="auth-description">
                        Nhập email hoặc số điện thoại để nhận liên kết khôi phục hoặc mã OTP.
                    </p>

                    <div class="password-illustration">
                        <i class="fas fa-lock fa-10x"></i>
                    </div>

                    <div class="recovery-tips">
                        <h3>Mẹo khôi phục nhanh</h3>
                        <ul>
                            <li>
                                <i class="fas fa-check-circle"></i>
                                Dùng email đã đăng ký tài khoản.
                            </li>
                            <li>
                                <i class="fas fa-check-circle"></i>
                                Kiểm tra hộp thư <strong>Spam/Quảng cáo</strong> nếu chưa thấy email.
                            </li>
                            <li>
                                <i class="fas fa-check-circle"></i>
                                Liên hệ CSKH nếu không truy cập được email.
                            </li>
                        </ul>
                    </div>

                    <div class="support-section">
                        <button type="button" class="btn-support">
                            <i class="fas fa-headset me-2"></i>
                            Liên hệ hỗ trợ
                        </button>
                    </div>

                    <div class="security-section">
                        <h3>Bảo mật & Quyền riêng tư</h3>
                        <p>
                            Chúng tôi chỉ dùng thông tin để xác minh và đặt lại mật khẩu.
                        </p>
                        <p>
                            Không chia sẻ mã OTP/đường link cho người khác.
                        </p>
                        <button type="button" class="btn-details">
                            <i class="fas fa-info-circle me-2"></i>
                            Xem chi tiết
                        </button>
                    </div>
                </div>
            </div>

            <!-- Right Side - Form -->
            <div class="col-lg-7">
                <div class="auth-right-panel">
                    <h2 class="form-title">Chọn phương thức</h2>

                    <!-- Method Selection -->
                    <div class="method-selection">
                        <label class="method-option">
                            <input type="radio" name="method" value="email" checked>
                            <span class="method-label">
                                    <i class="fas fa-envelope me-2"></i>
                                    Gửi liên kết đặt lại qua Email
                                </span>
                        </label>
                        <label class="method-option">
                            <input type="radio" name="method" value="sms">
                            <span class="method-label">
                                    <i class="fas fa-sms me-2"></i>
                                    Gửi mã OTP qua SMS
                                </span>
                        </label>
                    </div>

                    <!-- Email Form -->
                    <form id="emailForm" class="recovery-form active" th:action="@{/auth/forgot-password/email}" method="post">
                        <div class="form-group">
                            <label for="email">Email</label>
                            <input type="email"
                                   class="form-control"
                                   id="email"
                                   name="email"
                                   placeholder="you@example.com"
                                   required>
                        </div>

                        <button type="submit" class="btn-submit">
                            <i class="fas fa-paper-plane me-2"></i>
                            Gửi liên kết đặt lại
                        </button>

                        <button type="button" class="btn-back" onclick="window.location.href='/auth/login'">
                            <i class="fas fa-arrow-left me-2"></i>
                            Quay lại đăng nhập
                        </button>
                    </form>

                    <!-- SMS Form -->
                    <form id="smsForm" class="recovery-form" th:action="@{/auth/forgot-password/sms}" method="post">
                        <div class="form-group">
                            <label for="phone">Số điện thoại (nếu dùng SMS)</label>
                            <div class="phone-input-group">
                                <input type="tel"
                                       class="form-control"
                                       id="phone"
                                       name="phone"
                                       placeholder="0912345678"
                                       required>
                                <button type="button" class="btn-send-otp">
                                    Gửi mã OTP
                                </button>
                            </div>
                        </div>

                        <button type="submit" class="btn-submit">
                            <i class="fas fa-paper-plane me-2"></i>
                            Xác nhận OTP
                        </button>

                        <button type="button" class="btn-back" onclick="window.location.href='/auth/login'">
                            <i class="fas fa-arrow-left me-2"></i>
                            Quay lại đăng nhập
                        </button>
                    </form>

                    <!-- Success Message -->
                    <div id="successMessage" class="success-message" style="display: none;">
                        <div class="success-icon">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <h3>Đã gửi liên kết đặt lại mật khẩu!</h3>
                        <p>
                            Vui lòng kiểm tra email <strong id="sentEmail">you@example.com</strong>.
                            Liên kết có hiệu lực trong <strong>15 phút</strong>.
                        </p>

                        <div class="help-section">
                            <h4>Chưa nhận được email?</h4>
                            <ul>
                                <li>Kiểm tra mục <strong>Spam/Quảng cáo</strong></li>
                                <li>Thử lại sau vài phút hoặc dùng phương thức SMS</li>
                            </ul>
                            <button type="button" class="btn-resend" onclick="resendEmail()">
                                <i class="fas fa-redo me-2"></i>
                                Gửi lại email
                            </button>
                        </div>
                    </div>

                    <!-- Footer Note -->
                    <div class="form-footer">
                        <p>
                            Bằng việc yêu cầu đặt lại, bạn đồng ý tuân thủ
                            <strong>Chính sách bảo mật</strong> của NiceSport.
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="auth-footer">
        <p>© 2025 NiceSport. All rights reserved.</p>
    </footer>
</div>

<!-- JavaScript -->
<script>
    // Toggle between Email and SMS forms
    document.querySelectorAll('input[name="method"]').forEach(radio => {
        radio.addEventListener('change', function() {
            const emailForm = document.getElementById('emailForm');
            const smsForm = document.getElementById('smsForm');

            if (this.value === 'email') {
                emailForm.classList.add('active');
                smsForm.classList.remove('active');
            } else {
                emailForm.classList.remove('active');
                smsForm.classList.add('active');
            }
        });
    });

    // Handle Email Form Submit
    document.getElementById('emailForm').addEventListener('submit', function(e) {
        e.preventDefault();

        const email = document.getElementById('email').value;

        // Show success message
        document.querySelector('.auth-right-panel > h2').style.display = 'none';
        document.querySelector('.method-selection').style.display = 'none';
        document.querySelectorAll('.recovery-form').forEach(form => {
            form.style.display = 'none';
        });

        const successMessage = document.getElementById('successMessage');
        document.getElementById('sentEmail').textContent = email;
        successMessage.style.display = 'block';

        // In production, send AJAX request to backend
        // fetch('/auth/forgot-password/email', { ... })
    });

    // Handle SMS Form Submit
    document.getElementById('smsForm').addEventListener('submit', function(e) {
        e.preventDefault();

        const phone = document.getElementById('phone').value;

        // Show success message
        alert('Đã gửi mã OTP đến số điện thoại: ' + phone);

        // In production, send AJAX request to backend
        // fetch('/auth/forgot-password/sms', { ... })
    });

    // Send OTP Button
    document.querySelector('.btn-send-otp').addEventListener('click', function() {
        const phone = document.getElementById('phone').value;

        if (!phone) {
            alert('Vui lòng nhập số điện thoại');
            return;
        }

        // Disable button and show loading
        this.disabled = true;
        this.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Đang gửi...';

        // Simulate sending OTP
        setTimeout(() => {
            this.disabled = false;
            this.innerHTML = 'Gửi lại (59s)';
            alert('Đã gửi mã OTP đến số: ' + phone);

            // Countdown timer
            let countdown = 59;
            const interval = setInterval(() => {
                countdown--;
                if (countdown > 0) {
                    this.innerHTML = `Gửi lại (${countdown}s)`;
                } else {
                    this.innerHTML = 'Gửi mã OTP';
                    this.disabled = false;
                    clearInterval(interval);
                }
            }, 1000);
        }, 2000);

        // In production, send AJAX request
        // fetch('/auth/send-otp', { ... })
    });

    // Resend Email Function
    function resendEmail() {
        const email = document.getElementById('sentEmail').textContent;
        alert('Đã gửi lại email đến: ' + email);

        // In production, send AJAX request
        // fetch('/auth/resend-email', { ... })
    }
</script>
</body>
</html>